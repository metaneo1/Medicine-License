@using System.Drawing
@using System.Web.UI.WebControls
@using DataModel.DataTypeConverters
@using MvcBaseApp.Resources

@model DataModel.LicenseRequest

@{
    Layout = null;
}

@Html.DevExpress().CallbackPanel(s =>
{
    s.Name = "pnl_Request";
    s.CallbackRouteValues = new { Controller = "Message", Action = "LicenseRequestPartial" };

    s.SetContent(() =>
    {
        Html.DevExpress().FormLayout(settings =>
        {
            settings.Name = "AddLicenseRequestFormLayout";
            settings.AlignItemCaptionsInAllGroups = true;
            settings.Items.AddGroupItem(g =>
            {
                g.Caption = Labels.LicenseRequest_MainInfo;
                g.ColCount = 1;
                g.Items.Add(m => m.DateCreate, i =>
                {
                    i.ClientVisible = Html.HasRoleView(Session, "LicenseRequest_DateCreate");
                    i.NestedExtension().DateEdit(tb =>
                    {
                        tb.Properties.UseMaskBehavior = true;
                        tb.Properties.EditFormat = EditFormat.Custom;
                        tb.Properties.EditFormatString = DataTypeFormatter.DateFormat;
                        tb.Properties.TimeSectionProperties.Visible = false;
                        tb.Width = Unit.Pixel(250);
                        tb.Properties.ValidationSettings.Display = Display.Dynamic;
                        tb.Properties.ValidationSettings.ErrorDisplayMode = ErrorDisplayMode.None;
                        if (!Html.HasRoleEnable(Session, "LicenseRequest_DateCreate"))
                        {
                            tb.Enabled = false;
                            tb.Properties.Style.BackColor = Color.LightGray;
                            tb.Properties.Style.ForeColor = Color.Black;
                        }
                    });
                }).Caption = Labels.LicenseRequest_DateCreate;
                g.Items.Add(m => m.ClinicName, i =>
                {
                    i.ClientVisible = Html.HasRoleView(Session, "LicenseRequest_ClinicName");
                    i.NestedExtension().TextBox(tb =>
                    {
                        tb.Width = Unit.Pixel(250);
                        tb.ShowModelErrors = true;
                        tb.Properties.ValidationSettings.Display = Display.Dynamic;
                        tb.Properties.ValidationSettings.ErrorDisplayMode = ErrorDisplayMode.None;
                        if (!Html.HasRoleEnable(Session, "LicenseRequest_ClinicName"))
                        {
                            tb.Enabled = false;
                            tb.Properties.Style.BackColor = Color.LightGray;
                            tb.Properties.Style.ForeColor = Color.Black;
                        }
                    });
                }).Caption = Labels.LicenseRequest_ClinicName;
                g.Items.Add(m => m.Address, i =>
                {
                    i.ClientVisible = Html.HasRoleView(Session, "LicenseRequest_Address");
                    i.NestedExtension().TextBox(tb =>
                    {
                        tb.Width = Unit.Pixel(250);
                        tb.ShowModelErrors = true;
                        tb.Properties.ValidationSettings.Display = Display.Dynamic;
                        tb.Properties.ValidationSettings.ErrorDisplayMode = ErrorDisplayMode.None;
                        if (!Html.HasRoleEnable(Session, "LicenseRequest_Address"))
                        {
                            tb.Enabled = false;
                            tb.Properties.Style.BackColor = Color.LightGray;
                            tb.Properties.Style.ForeColor = Color.Black;
                        }
                    });
                }).Caption = Labels.LicenseRequest_Address;
                g.Items.Add(m => m.Phone1, i =>
                {
                    i.ClientVisible = Html.HasRoleView(Session, "LicenseRequest_Phone1");
                    i.NestedExtension().TextBox(tb =>
                    {
                        tb.Width = Unit.Pixel(250);
                        tb.ShowModelErrors = true;
                        tb.Properties.ValidationSettings.Display = Display.Dynamic;
                        tb.Properties.ValidationSettings.ErrorDisplayMode = ErrorDisplayMode.None;
                        if (!Html.HasRoleEnable(Session, "LicenseRequest_Phone1"))
                        {
                            tb.Enabled = false;
                            tb.Properties.Style.BackColor = Color.LightGray;
                            tb.Properties.Style.ForeColor = Color.Black;
                        }
                    });
                }).Caption = Labels.LicenseRequest_Phone1;
                g.Items.Add(m => m.Phone2, i =>
                {
                    i.ClientVisible = Html.HasRoleView(Session, "LicenseRequest_Phone2");
                    i.NestedExtension().TextBox(tb =>
                    {
                        tb.Width = Unit.Pixel(250);
                        tb.ShowModelErrors = true;
                        tb.Properties.ValidationSettings.Display = Display.Dynamic;
                        tb.Properties.ValidationSettings.ErrorDisplayMode = ErrorDisplayMode.None;
                        if (!Html.HasRoleEnable(Session, "LicenseRequest_Phone2"))
                        {
                            tb.Enabled = false;
                            tb.Properties.Style.BackColor = Color.LightGray;
                            tb.Properties.Style.ForeColor = Color.Black;
                        }
                    });
                }).Caption = Labels.LicenseRequest_Phone2;
                g.Items.Add(m => m.Email, i =>
                {
                    i.Caption = Labels.ResourceManager.GetString("LicenseRequest_Email");
                    i.ClientVisible = Html.HasRoleView(Session, "LicenseRequest_Email");
                    i.NestedExtension().TextBox(tb =>
                    {
                        tb.Width = Unit.Pixel(250);
                        tb.ShowModelErrors = true;
                        tb.Properties.ValidationSettings.Display = Display.Dynamic;
                        tb.Properties.ValidationSettings.ErrorDisplayMode = ErrorDisplayMode.None;
                        if (!Html.HasRoleEnable(Session, "LicenseRequest_Email"))
                        {
                            tb.Enabled = false;
                            tb.Properties.Style.BackColor = Color.LightGray;
                            tb.Properties.Style.ForeColor = Color.Black;
                        }
                    });
                });
                //g.Items.Add(m => m.Id_AdminUnit, i =>
                //{
                //    i.ClientVisible = Html.HasRoleView(Session, "LicenseRequest_Id_AdminUnit");
                //    i.SetNestedContent(Html.Action("GetLookUp", "AdminUnits", new { JsElementName = "Id_AdminUnit_AddLicenseRequest", CallerConrtoller = "AddLicenseRequest", CurrentValue = Model.Id_AdminUnit }).ToString());
                //}); //.Caption = Labels.LicenseRequest_AdminUnits;
                //g.Items.Add(m => m.Id_Company, i =>
                //{
                //    i.ClientVisible = Html.HasRoleView(Session, "LicenseRequest_Id_Company");
                //    i.SetNestedContent(Html.Action("GetLookUp", "Organization", new { JsElementName = "Id_Company_AddLicenseRequest", CallerConrtoller = "AddLicenseRequest", CurrentValue = Model.Id_Company }).ToString());
                //}); //.Caption = Labels.LicenseRequest_AdminUnits;
                //g.Items.Add(m => m.Id_RequestType, i =>
                //{
                //    i.ClientVisible = Html.HasRoleView(Session, "LicenseRequest_Id_RequestType");
                //    i.SetNestedContent(Html.Action("GetLookUp", "RequestType", new { JsElementName = "Id_RequestType_AddLicenseRequest", CallerConrtoller = "AddLicenseRequest", CurrentValue = Model.Id_RequestType }).ToString());
                //}); //.Caption = Labels.LicenseRequest_AdminUnits;
                //g.Items.Add(m => m.Id_User, i =>
                //{
                //    i.ClientVisible = Html.HasRoleView(Session, "LicenseRequest_Id_User");
                //    i.SetNestedContent(Html.Action("GetLookUp", "RequestType", new { JsElementName = "Id_User_AddLicenseRequest", CallerConrtoller = "AddLicenseRequest", CurrentValue = Model.Id_User }).ToString());
                //}); //.Caption = Labels.LicenseRequest_AdminUnits;
                //g.Items.Add(m => m.Id_CurrentState, i =>
                //{
                //    i.ClientVisible = Html.HasRoleView(Session, "LicenseRequest_Id_CurrentState");
                //    i.SetNestedContent(Html.Action("GetLookUp", "RequestState", new { JsElementName = "Id_CurrentState_AddLicenseRequest", CallerConrtoller = "RequestState", CurrentValue = Model.Id_CurrentState }).ToString());
                //}); //.Caption = Labels.LicenseRequest_AdminUnits;
            });
        }).GetHtml();

    });

    ////settings.Name = Model.Name;
    //settings.Name = "pnl_Request";
    ////settings.CallbackRouteValues = new { Controller = Model.Controller, Action = Model.Action, FilterId = Model.FilterId };
    //settings.CallbackRouteValues = new { Controller = "Message", Action = "LicenseRequestPartial", FilterId = 2 };

    ////settings.Height = Unit.Pixel(130);
    ////settings.Width = Unit.Pixel(320);
    ////settings.SetContent(() =>
    ////{
    ////    ViewContext.Writer.Write(           "<div style=\"vertical-align:middle\">" +
    ////                                        "The content of this popup control was updated at <b> " + DateTime.Now.ToLongTimeString() + "</b>" +
    ////                                        "</div>");
    ////    //ViewContext.Writer.Write(Model.Rendered.ToHtmlString());
    ////});
    //settings.ClientSideEvents.BeginCallback = "function(s, e) { alert('start'); }";
    //settings.ClientSideEvents.EndCallback = "function(s, e) { alert('end');}";
}).GetHtml()